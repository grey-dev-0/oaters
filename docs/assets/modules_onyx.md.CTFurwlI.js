import{_ as a,c as e,o as i,a5 as s}from"./chunks/framework.MXlVYeMd.js";const h=JSON.parse('{"title":"Onyx Module","description":"","frontmatter":{},"headers":[],"relativePath":"modules/onyx.md","filePath":"modules/onyx.md"}'),t={name:"modules/onyx.md"};function o(l,n,r,p,c,u){return i(),e("div",null,n[0]||(n[0]=[s(`<h1 id="onyx-module" tabindex="-1">Onyx Module <a class="header-anchor" href="#onyx-module" aria-label="Permalink to &quot;Onyx Module&quot;">​</a></h1><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p><strong>Onyx</strong> is the inventory and procurement management module of the OATERS ERP system. It provides comprehensive functionality for managing inventory, tracking purchases, planning production, and monitoring consumption of materials and products. Onyx enables organizations to maintain optimal stock levels, plan procurement efficiently, and execute production plans with detailed tracking.</p><h2 id="business-functionality" tabindex="-1">Business Functionality <a class="header-anchor" href="#business-functionality" aria-label="Permalink to &quot;Business Functionality&quot;">​</a></h2><h3 id="core-features" tabindex="-1">Core Features <a class="header-anchor" href="#core-features" aria-label="Permalink to &quot;Core Features&quot;">​</a></h3><h4 id="_1-purchase-management" tabindex="-1">1. Purchase Management <a class="header-anchor" href="#_1-purchase-management" aria-label="Permalink to &quot;1. Purchase Management&quot;">​</a></h4><ul><li><strong>Purchase Orders</strong>: Create and manage procurement orders from suppliers</li><li><strong>Purchase Tracking</strong>: Monitor purchase status and payment tracking</li><li><strong>Payment Management</strong>: Integrate with financial module for bank account recording</li><li><strong>Purchase History</strong>: Audit trail of all purchase events and status changes</li><li><strong>Line Items</strong>: Detailed tracking of articles/products per purchase with quantity and pricing</li></ul><h4 id="_2-inventory-planning" tabindex="-1">2. Inventory Planning <a class="header-anchor" href="#_2-inventory-planning" aria-label="Permalink to &quot;2. Inventory Planning&quot;">​</a></h4><ul><li><strong>Product Plans</strong>: Define material requirements and production plans</li><li><strong>Quantity Planning</strong>: Specify required quantities with measurement units</li><li><strong>Plan Tracking</strong>: Monitor planned vs. actual consumption</li><li><strong>Resource Allocation</strong>: Assign plans to specific users for execution</li><li><strong>Article Integration</strong>: Link plans to specific articles for precise tracking</li></ul><h4 id="_3-production-execution" tabindex="-1">3. Production Execution <a class="header-anchor" href="#_3-production-execution" aria-label="Permalink to &quot;3. Production Execution&quot;">​</a></h4><ul><li><strong>Plan Execution</strong>: Execute production/consumption plans with real-time tracking</li><li><strong>Execution Status</strong>: Track execution progress (pending, in-progress, completed, failed)</li><li><strong>Consumption Tracking</strong>: Record actual material consumption against planned quantities</li><li><strong>Execution Logs</strong>: Detailed audit trail of all execution activities by user</li><li><strong>Notes &amp; Comments</strong>: Attach notes to executions for documentation</li></ul><h4 id="_4-consumption-monitoring" tabindex="-1">4. Consumption Monitoring <a class="header-anchor" href="#_4-consumption-monitoring" aria-label="Permalink to &quot;4. Consumption Monitoring&quot;">​</a></h4><ul><li><strong>Planned Consumption</strong>: Track consumption items defined in production plans</li><li><strong>Actual Consumption</strong>: Record real material consumption during execution</li><li><strong>Consumption History</strong>: Timeline of all consumption events with timestamps</li><li><strong>Variance Analysis</strong>: Compare planned vs. actual consumption</li><li><strong>Quantity Unit Support</strong>: Handle various measurement units (kg, liters, units, etc.)</li></ul><h2 id="technical-architecture" tabindex="-1">Technical Architecture <a class="header-anchor" href="#technical-architecture" aria-label="Permalink to &quot;Technical Architecture&quot;">​</a></h2><h3 id="technology-stack" tabindex="-1">Technology Stack <a class="header-anchor" href="#technology-stack" aria-label="Permalink to &quot;Technology Stack&quot;">​</a></h3><ul><li><strong>Framework</strong>: Laravel 10+</li><li><strong>Module System</strong>: nwidart/laravel-modules (^10.0)</li><li><strong>Database</strong>: MySQL/PostgreSQL (tenant-specific)</li><li><strong>Authentication</strong>: Integrated with Sapphire module</li><li><strong>Multi-tenancy</strong>: Tenant-scoped data via Sapphire module</li></ul><h2 id="database-schema" tabindex="-1">Database Schema <a class="header-anchor" href="#database-schema" aria-label="Permalink to &quot;Database Schema&quot;">​</a></h2><h3 id="core-models" tabindex="-1">Core Models <a class="header-anchor" href="#core-models" aria-label="Permalink to &quot;Core Models&quot;">​</a></h3><p><strong>Purchase Model</strong> (<code>Purchase.php</code>)</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Procurement orders and purchase records</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Table: o_purchases</span></span></code></pre></div><p>Schema:</p><ul><li>id: Primary key (increments)</li><li>contact_id: Foreign key to contacts (supplier)</li><li>bank_account_id: Foreign key to bank accounts (nullable - payment method)</li><li>amount: Total purchase amount (float)</li><li>paid: Payment status (boolean, default false)</li><li>received_at: Timestamp when goods were received (nullable)</li><li>created_at, updated_at: Timestamps</li></ul><p>Relationships:</p><ul><li><code>contact()</code>: belongsTo(Contact) from Common module</li><li><code>bankAccount()</code>: belongsTo(BankAccount) from financial module</li><li><code>lines()</code>: hasMany(PurchaseLine)</li><li><code>history()</code>: hasMany(PurchaseHistory)</li></ul><p><strong>PurchaseLine Model</strong> (<code>PurchaseLine.php</code>)</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Individual line items in a purchase order</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Table: o_purchase_lines</span></span></code></pre></div><p>Schema:</p><ul><li>id: Primary key</li><li>purchase_id: Foreign key to purchases</li><li>article_id: Foreign key to articles (from Article module)</li><li>quantity: Ordered quantity (float)</li><li>quantity_unit: Unit of measurement (10 chars - kg, l, units, etc.)</li><li>price: Unit price (float)</li></ul><p>Relationships:</p><ul><li><code>purchase()</code>: belongsTo(Purchase)</li><li><code>article()</code>: belongsTo(Article)</li></ul><p><strong>PurchaseHistory Model</strong> (<code>PurchaseHistory.php</code>)</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Audit trail of purchase events and status changes</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Table: o_purchase_histories</span></span></code></pre></div><p>Schema:</p><ul><li>id: Primary key</li><li>purchase_id: Foreign key to purchases</li><li>event: Description of the event (text)</li><li>time: When the event occurred (timestamp)</li><li>created_at: Record creation time (nullable)</li></ul><p>Relationships:</p><ul><li><code>purchase()</code>: belongsTo(Purchase)</li></ul><p><strong>ProductPlan Model</strong> (<code>ProductPlan.php</code>)</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Production/consumption plans defining material requirements</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Table: o_product_plans</span></span></code></pre></div><p>Schema:</p><ul><li>id: Primary key</li><li>user_id: Foreign key to users (plan creator/owner)</li><li>article_id: Foreign key to articles (primary planned article)</li><li>quantity: Planned quantity (float)</li><li>quantity_unit: Unit of measurement (10 chars)</li></ul><p>Relationships:</p><ul><li><code>user()</code>: belongsTo(User) from Sapphire module</li><li><code>article()</code>: belongsTo(Article) from Article module</li><li><code>consumptions()</code>: hasMany(PlanConsumption)</li><li><code>executions()</code>: hasMany(PlanExecution)</li></ul><p><strong>PlanConsumption Model</strong> (<code>PlanConsumption.php</code>)</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Materials planned to be consumed for a production plan</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Table: o_plan_consumptions</span></span></code></pre></div><p>Schema:</p><ul><li>id: Primary key</li><li>product_plan_id: Foreign key to product plans</li><li>article_id: Foreign key to articles (consumption item)</li><li>quantity: Consumption quantity (float)</li><li>quantity_unit: Unit of measurement (10 chars)</li><li>created_at, updated_at: Timestamps</li></ul><p>Relationships:</p><ul><li><code>productPlan()</code>: belongsTo(ProductPlan)</li><li><code>article()</code>: belongsTo(Article)</li></ul><p><strong>PlanExecution Model</strong> (<code>PlanExecution.php</code>)</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Execution records of production plans with status tracking</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Table: o_plan_executions</span></span></code></pre></div><p>Schema:</p><ul><li>id: Primary key</li><li>user_id: Foreign key to users (executor)</li><li>product_plan_id: Foreign key to product plans (nullable - plan may be deleted)</li><li>plan_log_id: External plan log identifier (nullable string)</li><li>status: Execution status (tiny int: 0=pending, 1=in-progress, 2=completed, 3=failed)</li><li>note: Execution notes (text, nullable)</li><li>created_at, updated_at: Timestamps</li></ul><p>Relationships:</p><ul><li><code>user()</code>: belongsTo(User)</li><li><code>productPlan()</code>: belongsTo(ProductPlan)</li><li><code>consumptions()</code>: hasMany(ExecutionConsumption)</li><li><code>logs()</code>: hasMany(ExecutionLog)</li></ul><p><strong>ExecutionConsumption Model</strong> (<code>ExecutionConsumption.php</code>)</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Actual material consumption recorded during plan execution</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Table: o_execution_consumptions</span></span></code></pre></div><p>Schema:</p><ul><li>id: Primary key</li><li>plan_execution_id: Foreign key to plan executions</li><li>article_id: Foreign key to articles (nullable - article may be deleted)</li><li>quantity: Consumed quantity (float)</li><li>quantity_unit: Unit of measurement (10 chars)</li><li>created_at, updated_at: Timestamps</li></ul><p>Relationships:</p><ul><li><code>planExecution()</code>: belongsTo(PlanExecution)</li><li><code>article()</code>: belongsTo(Article)</li></ul><p><strong>ExecutionLog Model</strong> (<code>ExecutionLog.php</code>)</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Audit trail of execution activities and status changes</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Table: o_execution_logs</span></span></code></pre></div><p>Schema:</p><ul><li>id: Primary key</li><li>user_id: Foreign key to users (who performed the action)</li><li>plan_execution_id: Foreign key to plan executions</li><li>status: Status at this log point (tiny int)</li><li>note: Log notes/comments (text, nullable)</li><li>created_at: When the log was created (nullable)</li></ul><p>Relationships:</p><ul><li><code>user()</code>: belongsTo(User)</li><li><code>planExecution()</code>: belongsTo(PlanExecution)</li></ul><h2 id="directory-structure" tabindex="-1">Directory Structure <a class="header-anchor" href="#directory-structure" aria-label="Permalink to &quot;Directory Structure&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Modules/Onyx/</span></span>
<span class="line"><span>├── App/</span></span>
<span class="line"><span>│   ├── Http/</span></span>
<span class="line"><span>│   │   └── Controllers/</span></span>
<span class="line"><span>│   │       └── [Controllers for purchase, plan, and execution management]</span></span>
<span class="line"><span>│   ├── Models/                   # Eloquent models (7 models)</span></span>
<span class="line"><span>│   │   ├── Purchase.php</span></span>
<span class="line"><span>│   │   ├── PurchaseLine.php</span></span>
<span class="line"><span>│   │   ├── PurchaseHistory.php</span></span>
<span class="line"><span>│   │   ├── ProductPlan.php</span></span>
<span class="line"><span>│   │   ├── PlanConsumption.php</span></span>
<span class="line"><span>│   │   ├── PlanExecution.php</span></span>
<span class="line"><span>│   │   ├── ExecutionConsumption.php</span></span>
<span class="line"><span>│   │   └── ExecutionLog.php</span></span>
<span class="line"><span>│   └── Providers/</span></span>
<span class="line"><span>│       └── ModuleServiceProvider.php</span></span>
<span class="line"><span>├── Database/</span></span>
<span class="line"><span>│   ├── Factories/               # Model factories for testing</span></span>
<span class="line"><span>│   ├── migrations/              # Database migrations</span></span>
<span class="line"><span>│   │   └── 2024_04_02_104108_onyx_base.php</span></span>
<span class="line"><span>│   └── Seeders/                # Database seeders</span></span>
<span class="line"><span>├── resources/</span></span>
<span class="line"><span>│   ├── views/                  # Blade templates</span></span>
<span class="line"><span>│   └── lang/                   # Translations</span></span>
<span class="line"><span>│       └── en/</span></span>
<span class="line"><span>├── routes/</span></span>
<span class="line"><span>│   ├── web.php                 # Web routes</span></span>
<span class="line"><span>│   └── api.php                 # API routes</span></span>
<span class="line"><span>├── config/</span></span>
<span class="line"><span>│   └── config.php              # Module configuration</span></span>
<span class="line"><span>└── module.json                 # Module metadata</span></span></code></pre></div><h2 id="key-relationships" tabindex="-1">Key Relationships <a class="header-anchor" href="#key-relationships" aria-label="Permalink to &quot;Key Relationships&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Contact (Common) (1) ─────── (N) Purchases (supplier)</span></span>
<span class="line"><span>BankAccount (Finance) (1) ─────── (N) Purchases (payment method)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Purchase (1) ─────── (N) PurchaseLines</span></span>
<span class="line"><span>Purchase (1) ─────── (N) PurchaseHistory</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PurchaseLine (N) ─────── (1) Article (Common/Article)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>User (Sapphire) (1) ─────── (N) ProductPlans</span></span>
<span class="line"><span>ProductPlan (1) ─────── (N) PlanConsumption</span></span>
<span class="line"><span>ProductPlan (1) ─────── (N) PlanExecution</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Article (Common/Article) (1) ─────── (N) PlanConsumption</span></span>
<span class="line"><span>Article (1) ─────── (N) ExecutionConsumption</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PlanExecution (1) ─────── (N) ExecutionConsumption</span></span>
<span class="line"><span>PlanExecution (1) ─────── (N) ExecutionLog</span></span>
<span class="line"><span></span></span>
<span class="line"><span>User (Sapphire) (1) ─────── (N) PlanExecution</span></span>
<span class="line"><span>User (1) ─────── (N) ExecutionLog</span></span></code></pre></div><h2 id="integration-with-other-modules" tabindex="-1">Integration with Other Modules <a class="header-anchor" href="#integration-with-other-modules" aria-label="Permalink to &quot;Integration with Other Modules&quot;">​</a></h2><h3 id="article-module-integration" tabindex="-1">Article Module Integration <a class="header-anchor" href="#article-module-integration" aria-label="Permalink to &quot;Article Module Integration&quot;">​</a></h3><p>Onyx integrates with the Article module for product/article management:</p><ul><li>References articles in purchase line items</li><li>Tracks consumption of articles in production plans</li><li>Links planned and actual consumption to specific articles</li></ul><h3 id="financial-module-integration" tabindex="-1">Financial Module Integration <a class="header-anchor" href="#financial-module-integration" aria-label="Permalink to &quot;Financial Module Integration&quot;">​</a></h3><p>Onyx connects to Financial module for payment tracking:</p><ul><li>Associates purchases with bank accounts</li><li>Tracks payment method for procurement</li><li>Enables financial reconciliation</li></ul><h3 id="common-module-integration" tabindex="-1">Common Module Integration <a class="header-anchor" href="#common-module-integration" aria-label="Permalink to &quot;Common Module Integration&quot;">​</a></h3><ul><li>Uses Contact records for supplier management</li><li>Integrates with User model for execution tracking</li></ul><h3 id="sapphire-module-integration" tabindex="-1">Sapphire Module Integration <a class="header-anchor" href="#sapphire-module-integration" aria-label="Permalink to &quot;Sapphire Module Integration&quot;">​</a></h3><ul><li>User authentication for plan creators and executors</li><li>Tenant-scoped data isolation</li></ul><h2 id="business-workflows" tabindex="-1">Business Workflows <a class="header-anchor" href="#business-workflows" aria-label="Permalink to &quot;Business Workflows&quot;">​</a></h2><h3 id="procurement-workflow" tabindex="-1">Procurement Workflow <a class="header-anchor" href="#procurement-workflow" aria-label="Permalink to &quot;Procurement Workflow&quot;">​</a></h3><ol><li><strong>Create Purchase Order</strong>: Define required articles and quantities</li><li><strong>Record Supplier</strong>: Link to contact (supplier)</li><li><strong>Specify Payment</strong>: Associate with bank account if pre-defined</li><li><strong>Track Purchase</strong>: Monitor purchase through system</li><li><strong>Record Receipt</strong>: Update received_at when goods arrive</li><li><strong>Mark Paid</strong>: Update payment status</li></ol><h3 id="production-planning-workflow" tabindex="-1">Production Planning Workflow <a class="header-anchor" href="#production-planning-workflow" aria-label="Permalink to &quot;Production Planning Workflow&quot;">​</a></h3><ol><li><strong>Create Product Plan</strong>: Define primary article and quantity</li><li><strong>Add Consumables</strong>: Link consumption articles and quantities</li><li><strong>Assign Executor</strong>: Associate with user responsible for execution</li><li><strong>Execute Plan</strong>: Create execution record and track consumption</li><li><strong>Record Consumption</strong>: Log actual material consumed</li><li><strong>Complete Execution</strong>: Mark as completed/failed with notes</li></ol><h2 id="consumption-tracking" tabindex="-1">Consumption Tracking <a class="header-anchor" href="#consumption-tracking" aria-label="Permalink to &quot;Consumption Tracking&quot;">​</a></h2><p>The module tracks consumption at two levels:</p><ol><li><strong>Planned Level</strong>: What you expect to consume (PlanConsumption)</li><li><strong>Actual Level</strong>: What was actually consumed (ExecutionConsumption)</li></ol><p>This enables:</p><ul><li>Variance analysis between planned and actual</li><li>Inventory adjustment</li><li>Cost tracking and analysis</li><li>Efficiency metrics</li></ul><h2 id="development-notes" tabindex="-1">Development Notes <a class="header-anchor" href="#development-notes" aria-label="Permalink to &quot;Development Notes&quot;">​</a></h2><ul><li><strong>Priority</strong>: 4</li><li><strong>Alias</strong>: onyx</li><li><strong>Service Provider</strong>: <code>Modules\\\\Onyx\\\\App\\\\Providers\\\\ModuleServiceProvider</code></li><li><strong>Dependencies</strong>: <ul><li><strong>Article module</strong> (for article/product references)</li><li><strong>Common module</strong> (for Contact/supplier management)</li><li><strong>Sapphire module</strong> (authentication/authorization)</li><li><strong>Financial module</strong> (optional - for bank account integration)</li></ul></li></ul><h2 id="future-enhancements" tabindex="-1">Future Enhancements <a class="header-anchor" href="#future-enhancements" aria-label="Permalink to &quot;Future Enhancements&quot;">​</a></h2><p>Planned expansions include:</p><ol><li><strong>Advanced Planning</strong>: AI-based inventory level recommendations</li><li><strong>Supply Chain</strong>: Multi-warehouse inventory distribution</li><li><strong>Quality Control</strong>: Defect tracking and quality metrics</li><li><strong>Forecasting</strong>: Predictive inventory requirements</li><li><strong>Vendor Management</strong>: Supplier performance tracking and ratings</li><li><strong>Order Automation</strong>: Automatic reorder when stock falls below threshold</li><li><strong>Cost Analysis</strong>: Detailed procurement cost analysis and reporting</li></ol>`,96)]))}const g=a(t,[["render",o]]);export{h as __pageData,g as default};
