import{_ as a,c as e,o as n,a5 as i}from"./chunks/framework.MXlVYeMd.js";const u=JSON.parse('{"title":"Sapphire Module","description":"","frontmatter":{},"headers":[],"relativePath":"modules/sapphire.md","filePath":"modules/sapphire.md"}'),t={name:"modules/sapphire.md"};function l(o,s,r,p,c,h){return n(),e("div",null,s[0]||(s[0]=[i(`<h1 id="sapphire-module" tabindex="-1">Sapphire Module <a class="header-anchor" href="#sapphire-module" aria-label="Permalink to &quot;Sapphire Module&quot;">​</a></h1><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p><strong>Sapphire</strong> is the foundational module of the OATERS ERP system, providing centralized authentication, authorization, multi-tenancy, and user management capabilities. As the security and access control hub, Sapphire manages all tenant organizations, their subscriptions to other modules, and user permissions across the entire system.</p><h2 id="business-functionality" tabindex="-1">Business Functionality <a class="header-anchor" href="#business-functionality" aria-label="Permalink to &quot;Business Functionality&quot;">​</a></h2><h3 id="core-features" tabindex="-1">Core Features <a class="header-anchor" href="#core-features" aria-label="Permalink to &quot;Core Features&quot;">​</a></h3><h4 id="_1-multi-tenancy-management" tabindex="-1">1. Multi-Tenancy Management <a class="header-anchor" href="#_1-multi-tenancy-management" aria-label="Permalink to &quot;1. Multi-Tenancy Management&quot;">​</a></h4><ul><li><strong>Tenant Registration</strong>: Onboard new business organizations to the OATERS platform</li><li><strong>Tenant Isolation</strong>: Complete data separation between different organizations</li><li><strong>Tenant Configuration</strong>: Customize settings and preferences per tenant</li><li><strong>Tenant Dashboard</strong>: Super admin overview of all registered tenants</li><li><strong>Tenant Authentication</strong>: Tenants can authenticate as super-admin users to manage their organization</li></ul><h4 id="_2-subscription-management" tabindex="-1">2. Subscription Management <a class="header-anchor" href="#_2-subscription-management" aria-label="Permalink to &quot;2. Subscription Management&quot;">​</a></h4><ul><li><strong>Module Subscriptions</strong>: Tenants can subscribe to specific modules (Onyx, Amethyst, Topaz, Emerald, Ruby)</li><li><strong>Subscription Plans</strong>: Different pricing tiers and feature sets</li><li><strong>Purchase Tracking</strong>: Record and manage module purchases</li><li><strong>Subscription Lifecycle</strong>: Handle activations, renewals, and cancellations</li></ul><h4 id="_3-user-management" tabindex="-1">3. User Management <a class="header-anchor" href="#_3-user-management" aria-label="Permalink to &quot;3. User Management&quot;">​</a></h4><ul><li><strong>User Registration</strong>: Create user accounts within tenant organizations</li><li><strong>User Profiles</strong>: Manage user information and preferences</li><li><strong>Contact Integration</strong>: Users link to Contact records from Common module for extended information</li><li><strong>User Status</strong>: Active, inactive, suspended user states</li></ul><h4 id="_4-role-based-access-control-rbac" tabindex="-1">4. Role-Based Access Control (RBAC) <a class="header-anchor" href="#_4-role-based-access-control-rbac" aria-label="Permalink to &quot;4. Role-Based Access Control (RBAC)&quot;">​</a></h4><ul><li><strong>Role Definition</strong>: Create custom roles with specific permissions</li><li><strong>Multi-language Support</strong>: Role names in multiple languages via translation system</li><li><strong>Permission Assignment</strong>: Granular permission control using Spatie Permission</li><li><strong>Role Assignment</strong>: Assign roles to users and tenants for access control</li></ul><h4 id="_5-authentication-authorization" tabindex="-1">5. Authentication &amp; Authorization <a class="header-anchor" href="#_5-authentication-authorization" aria-label="Permalink to &quot;5. Authentication &amp; Authorization&quot;">​</a></h4><ul><li><strong>Dual Authentication</strong>: Separate authentication for super-admin tenants and tenant-level users</li><li><strong>Secure Login</strong>: Tenant-aware authentication system</li><li><strong>Session Management</strong>: Secure session handling across modules</li><li><strong>Password Management</strong>: Reset, recovery, and security policies</li><li><strong>API Authentication</strong>: Token-based authentication for API access</li></ul><h2 id="technical-architecture" tabindex="-1">Technical Architecture <a class="header-anchor" href="#technical-architecture" aria-label="Permalink to &quot;Technical Architecture&quot;">​</a></h2><h3 id="technology-stack" tabindex="-1">Technology Stack <a class="header-anchor" href="#technology-stack" aria-label="Permalink to &quot;Technology Stack&quot;">​</a></h3><ul><li><strong>Framework</strong>: Laravel 10+</li><li><strong>Module System</strong>: nwidart/laravel-modules (^10.0)</li><li><strong>Multi-tenancy</strong>: stancl/tenancy (^3.8)</li><li><strong>Permission System</strong>: spatie/laravel-permission (^6.4)</li><li><strong>Localization</strong>: astrotomic/laravel-translatable (^11.12)</li><li><strong>Database</strong>: MySQL/PostgreSQL with tenant-specific databases</li><li><strong>Authentication</strong>: Laravel Sanctum/Passport</li></ul><h3 id="database-schema" tabindex="-1">Database Schema <a class="header-anchor" href="#database-schema" aria-label="Permalink to &quot;Database Schema&quot;">​</a></h3><h4 id="core-models" tabindex="-1">Core Models <a class="header-anchor" href="#core-models" aria-label="Permalink to &quot;Core Models&quot;">​</a></h4><p><strong>Tenant Model</strong> (<code>Tenant.php</code>)</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Represents a super-admin tenant organization</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Extends Stancl\\Tenancy\\Database\\Models\\Tenant</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Implements: Authenticatable, Authorizable, CanResetPassword</span></span></code></pre></div><p>Key Features:</p><ul><li>Tenants are authenticatable users (can login as super-admin)</li><li>Uses traits: <code>Authenticatable</code>, <code>Authorizable</code>, <code>CanResetPassword</code>, <code>MustVerifyEmail</code>, <code>HasDatabase</code>, <code>HasDomains</code>, <code>HasRoles</code></li><li>Custom columns: <code>id</code>, <code>user_id</code>, <code>name</code>, <code>email</code>, <code>password</code>, <code>hash</code></li></ul><p>Schema:</p><ul><li>id: Primary key (auto-increment)</li><li>user_id: Associated user ID</li><li>name: Organization name</li><li>email: Contact email</li><li>password: Hashed password for authentication</li><li>hash: Security hash</li><li>created_at, updated_at</li></ul><p>Relationships:</p><ul><li><code>subscriptions()</code>: hasMany(Subscription)</li></ul><p><strong>User Model</strong> (<code>User.php</code>)</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Tenant-level users who access the system</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Table: s_users</span></span></code></pre></div><p>Schema:</p><ul><li>id: Primary key (auto-increment)</li><li>username: User login name</li><li>password: Hashed password (100 chars)</li><li>image: Profile image path (nullable)</li><li>created_at, updated_at</li></ul><p>Relationships:</p><ul><li><code>contact()</code>: hasOne(Contact) - Links to Common module Contact for extended info</li></ul><p>Features:</p><ul><li>Uses <code>HasFactory</code> and <code>HasRoles</code> traits</li><li>Integrates with Spatie Permission for role management</li><li>Links to Common module Contact for additional user information</li></ul><p><strong>Role Model</strong> (<code>Role.php</code>)</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// User roles for permission management</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Extends Spatie\\Permission\\Models\\Role</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Table: roles (from Spatie Permission)</span></span></code></pre></div><p>Features:</p><ul><li>Uses <code>Translatable</code> trait from Astrotomic</li><li>Translated attribute: <code>title</code></li><li>Inherits all Spatie Permission functionality</li></ul><p>Schema (from Spatie Permission migration):</p><ul><li>id: Primary key</li><li>name: Role identifier (slug)</li><li>guard_name: Authentication guard</li><li>team_foreign_key: For team support (nullable)</li><li>created_at, updated_at</li></ul><p>Relationships:</p><ul><li><code>translations()</code>: hasMany(RoleLocale) - via Astrotomic Translatable</li><li>Plus all Spatie Permission relationships (permissions, users, etc.)</li></ul><p><strong>RoleLocale Model</strong> (<code>RoleLocale.php</code>)</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Localized role information</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Table: role_locales (singular: role_locales)</span></span></code></pre></div><p>Schema:</p><ul><li>id: Primary key</li><li>role_id: Foreign key to roles</li><li>locale: Language code (en, ar, etc.) - 2 chars</li><li>title: Translated role name</li></ul><p>Relationships:</p><ul><li><code>role()</code>: belongsTo(Role)</li></ul><p><strong>Module Model</strong> (<code>Module.php</code>)</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Available OATERS modules for subscription</span></span></code></pre></div><p>Schema:</p><ul><li>id: Primary key</li><li>name: Module name (Onyx, Amethyst, Topaz, Emerald, Ruby)</li><li>slug: Module identifier</li><li>description: Module description</li><li>price: Base subscription price</li><li>status: active/inactive</li><li>No timestamps</li></ul><p>Relationships:</p><ul><li><code>subscriptions()</code>: belongsToMany(Subscription) via <code>tenant_modules</code> pivot</li></ul><p><strong>Subscription Model</strong> (<code>Subscription.php</code>)</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Tenant subscriptions to modules</span></span></code></pre></div><p>Schema:</p><ul><li>id: Primary key</li><li>tenant_id: Foreign key to tenants</li><li>status: active/expired/cancelled</li><li>start_date: Subscription start</li><li>end_date: Subscription expiry</li><li>created_at, updated_at</li></ul><p>Relationships:</p><ul><li><code>tenant()</code>: belongsTo(Tenant)</li><li><code>modules()</code>: belongsToMany(Module) via <code>tenant_modules</code> pivot table</li></ul><p><strong>Purchase Model</strong> (<code>Purchase.php</code>)</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Purchase transactions for subscriptions</span></span></code></pre></div><p>Schema:</p><ul><li>id: Primary key</li><li>subscription_id: Foreign key to subscriptions</li><li>amount: Purchase amount</li><li>payment_method: Payment type</li><li>status: pending/completed/failed</li><li>created_at, updated_at</li></ul><p>Relationships:</p><ul><li><code>subscription()</code>: belongsTo(Subscription)</li></ul><h2 id="directory-structure" tabindex="-1">Directory Structure <a class="header-anchor" href="#directory-structure" aria-label="Permalink to &quot;Directory Structure&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Modules/Sapphire/</span></span>
<span class="line"><span>├── App/</span></span>
<span class="line"><span>│   ├── Http/</span></span>
<span class="line"><span>│   │   ├── Controllers/</span></span>
<span class="line"><span>│   │   │   ├── Admin/</span></span>
<span class="line"><span>│   │   │   │   ├── DashboardController.php</span></span>
<span class="line"><span>│   │   │   │   ├── ModuleController.php</span></span>
<span class="line"><span>│   │   │   │   ├── PurchaseController.php</span></span>
<span class="line"><span>│   │   │   │   └── TenantController.php</span></span>
<span class="line"><span>│   │   │   └── User/</span></span>
<span class="line"><span>│   │   │       └── ModuleController.php</span></span>
<span class="line"><span>│   │   └── Middleware/           # Module-specific middleware</span></span>
<span class="line"><span>│   ├── Models/                   # Eloquent models</span></span>
<span class="line"><span>│   │   ├── Tenant.php</span></span>
<span class="line"><span>│   │   ├── User.php</span></span>
<span class="line"><span>│   │   ├── Role.php</span></span>
<span class="line"><span>│   │   ├── RoleLocale.php</span></span>
<span class="line"><span>│   │   ├── Module.php</span></span>
<span class="line"><span>│   │   ├── Subscription.php</span></span>
<span class="line"><span>│   │   └── Purchase.php</span></span>
<span class="line"><span>│   └── Providers/                # Service providers</span></span>
<span class="line"><span>│       └── ModuleServiceProvider.php</span></span>
<span class="line"><span>├── Database/</span></span>
<span class="line"><span>│   ├── factories/                # Model factories</span></span>
<span class="line"><span>│   ├── migrations/               # Database migrations</span></span>
<span class="line"><span>│   │   ├── 2024_04_02_104130_sapphire_base.php</span></span>
<span class="line"><span>│   │   └── 2024_04_09_191538_sapphire_permissions.php</span></span>
<span class="line"><span>│   └── seeders/                  # Database seeders</span></span>
<span class="line"><span>├── resources/</span></span>
<span class="line"><span>│   ├── views/                    # Blade templates</span></span>
<span class="line"><span>│   └── lang/                     # Translations</span></span>
<span class="line"><span>│       └── en/</span></span>
<span class="line"><span>├── routes/</span></span>
<span class="line"><span>│   ├── web.php                   # Web routes</span></span>
<span class="line"><span>│   └── api.php                   # API routes</span></span>
<span class="line"><span>├── config/</span></span>
<span class="line"><span>│   └── config.php                # Module configuration</span></span>
<span class="line"><span>└── module.json                   # Module metadata</span></span></code></pre></div><h2 id="key-relationships" tabindex="-1">Key Relationships <a class="header-anchor" href="#key-relationships" aria-label="Permalink to &quot;Key Relationships&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Tenant (1) ─────── (N) Subscriptions</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Subscription (N) ─────── (N) Modules (via tenant_modules pivot)</span></span>
<span class="line"><span>Subscription (1) ─────── (N) Purchases</span></span>
<span class="line"><span></span></span>
<span class="line"><span>User (1) ─────── (1) Contact (Common module)</span></span>
<span class="line"><span>User (N) ─────── (N) Roles (via Spatie Permission)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Role (1) ─────── (N) RoleLocale</span></span>
<span class="line"><span>Role (N) ─────── (N) Permissions (via Spatie Permission)</span></span>
<span class="line"><span>Role (N) ─────── (N) Users (via Spatie Permission)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Tenant (1) ─────── (N) Roles (via Spatie Permission HasRoles trait)</span></span></code></pre></div><h2 id="tenancy-implementation" tabindex="-1">Tenancy Implementation <a class="header-anchor" href="#tenancy-implementation" aria-label="Permalink to &quot;Tenancy Implementation&quot;">​</a></h2><p>Sapphire uses <code>stancl/tenancy</code> for multi-tenancy:</p><ol><li><strong>Tenant Identification</strong>: By subdomain or domain</li><li><strong>Database Separation</strong>: Each tenant has isolated database</li><li><strong>Automatic Tenant Context</strong>: Middleware ensures tenant-specific data access</li><li><strong>Central Database</strong>: Stores tenant information and global data</li><li><strong>Tenant Authentication</strong>: Tenants can authenticate as super-admins to manage their organization</li></ol><h2 id="permission-system" tabindex="-1">Permission System <a class="header-anchor" href="#permission-system" aria-label="Permalink to &quot;Permission System&quot;">​</a></h2><p>Uses <strong>Spatie Permission</strong> package for RBAC:</p><ol><li><strong>Roles</strong>: Defined with localized names via Astrotomic Translatable</li><li><strong>Permissions</strong>: Granular permissions assigned to roles</li><li><strong>Guards</strong>: Support for multiple authentication guards</li><li><strong>Teams</strong>: Optional team-based permissions</li><li><strong>Direct Permissions</strong>: Can assign permissions directly to users/tenants</li></ol><h2 id="how-other-modules-use-sapphire" tabindex="-1">How Other Modules Use Sapphire <a class="header-anchor" href="#how-other-modules-use-sapphire" aria-label="Permalink to &quot;How Other Modules Use Sapphire&quot;">​</a></h2><p>All other modules (Onyx, Amethyst, Topaz, Emerald, Ruby) depend on Sapphire for:</p><ol><li><strong>Authentication</strong>: User login and session management</li><li><strong>Authorization</strong>: Permission checks via Spatie Permission</li><li><strong>Tenant Context</strong>: Automatic data scoping to current tenant</li><li><strong>User Information</strong>: Access to user profiles</li><li><strong>Contact Integration</strong>: Extended user information via Common module Contact</li></ol><h3 id="example-integration" tabindex="-1">Example Integration <a class="header-anchor" href="#example-integration" aria-label="Permalink to &quot;Example Integration&quot;">​</a></h3><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// In any module controller</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Modules\\Sapphire\\App\\Models\\User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Modules\\Sapphire\\App\\Models\\Tenant</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Get current tenant</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$tenant </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Tenant</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">current</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Get current user</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> auth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">user</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Check permission (via Spatie Permission)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ($user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">can</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;manage-inventory&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Allow access to Onyx inventory features</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Get user&#39;s contact information</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$contact </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">contact;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Check role</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ($user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hasRole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;admin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Admin-specific logic</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="integration-with-common-module" tabindex="-1">Integration with Common Module <a class="header-anchor" href="#integration-with-common-module" aria-label="Permalink to &quot;Integration with Common Module&quot;">​</a></h2><p>Sapphire&#39;s User model integrates with the Common module&#39;s Contact model:</p><ul><li>Users have a one-to-one relationship with Contact</li><li>Contact stores extended information (phones, emails, addresses, etc.)</li><li>This separation allows for flexible user management</li><li>Contact can be shared across multiple modules (e.g., Ruby for employees)</li></ul><h2 id="api-endpoints" tabindex="-1">API Endpoints <a class="header-anchor" href="#api-endpoints" aria-label="Permalink to &quot;API Endpoints&quot;">​</a></h2><h3 id="admin-routes" tabindex="-1">Admin Routes <a class="header-anchor" href="#admin-routes" aria-label="Permalink to &quot;Admin Routes&quot;">​</a></h3><ul><li>Tenant management (CRUD)</li><li>Module management</li><li>Purchase tracking</li><li>Dashboard statistics</li></ul><h3 id="user-routes" tabindex="-1">User Routes <a class="header-anchor" href="#user-routes" aria-label="Permalink to &quot;User Routes&quot;">​</a></h3><ul><li>Module subscription browsing</li><li>User profile management</li><li>Role and permission viewing</li></ul><h2 id="security-considerations" tabindex="-1">Security Considerations <a class="header-anchor" href="#security-considerations" aria-label="Permalink to &quot;Security Considerations&quot;">​</a></h2><ol><li><strong>Password Hashing</strong>: All passwords use Laravel&#39;s bcrypt hashing</li><li><strong>Password Reset</strong>: Secure token-based password recovery</li><li><strong>Email Verification</strong>: Optional email verification for users/tenants</li><li><strong>Role-Based Access</strong>: Granular control over features and data</li><li><strong>Tenant Isolation</strong>: Complete data separation between organizations</li><li><strong>Session Security</strong>: Secure session handling with CSRF protection</li><li><strong>API Authentication</strong>: Token-based auth for API access</li></ol><h2 id="development-notes" tabindex="-1">Development Notes <a class="header-anchor" href="#development-notes" aria-label="Permalink to &quot;Development Notes&quot;">​</a></h2><ul><li><strong>Priority</strong>: 0 (highest - loads first)</li><li><strong>Alias</strong>: sapphire</li><li><strong>Service Provider</strong>: <code>Modules\\Sapphire\\App\\Providers\\ModuleServiceProvider</code></li><li><strong>Dependencies</strong>: Common module (for Contact integration)</li><li><strong>Required Packages</strong>: stancl/tenancy, spatie/laravel-permission, astrotomic/laravel-translatable</li></ul>`,95)]))}const g=a(t,[["render",l]]);export{u as __pageData,g as default};
